<div>
	<app-api-error [errorMessage]="apiError"></app-api-error>
	<h2>Pessoas</h2>
	<div style="margin-bottom: 16px;">
		<button mat-raised-button color="primary" (click)="createPerson()">
			<mat-icon>add</mat-icon> Adicionar Pessoa
		</button>
	</div>
	<div style="margin-bottom: 0;">
		<mat-form-field appearance="fill" style="min-width: 200px; margin-bottom: 0;">
			<mat-label>Tipo de Pessoa</mat-label>
			<mat-select [(ngModel)]="selectedType" (selectionChange)="onTypeFilterChange()">
				<mat-option value="">Todos</mat-option>
				<mat-option *ngFor="let type of personTypes" [value]="type">{{ type }}</mat-option>
			</mat-select>
		</mat-form-field>
	</div>
	<div *ngIf="loading" style="text-align:center; margin:32px 0;">
		<mat-spinner></mat-spinner>
	</div>
	<table mat-table [dataSource]="persons" class="mat-elevation-z8" *ngIf="!loading && persons.length > 0; else empty">
		<ng-container matColumnDef="id">
			<th mat-header-cell *matHeaderCellDef>ID</th>
			<td mat-cell *matCellDef="let person">{{ person.id }}</td>
		</ng-container>
		<ng-container matColumnDef="login">
			<th mat-header-cell *matHeaderCellDef>Login</th>
			<td mat-cell *matCellDef="let person">{{ person.login }}</td>
		</ng-container>
		<ng-container matColumnDef="name">
			<th mat-header-cell *matHeaderCellDef>Nome</th>
			<td mat-cell *matCellDef="let person">{{ person.name }}</td>
		</ng-container>
		<ng-container matColumnDef="cpf">
			<th mat-header-cell *matHeaderCellDef>CPF</th>
			<td mat-cell *matCellDef="let person">{{ person.cpf }}</td>
		</ng-container>
		<ng-container matColumnDef="email">
			<th mat-header-cell *matHeaderCellDef>Email</th>
			<td mat-cell *matCellDef="let person">{{ person.email }}</td>
		</ng-container>
		<ng-container matColumnDef="address">
			<th mat-header-cell *matHeaderCellDef>Endereço</th>
			<td mat-cell *matCellDef="let person">{{ person.address }}</td>
		</ng-container>
		<ng-container matColumnDef="type">
			<th mat-header-cell *matHeaderCellDef>Tipo</th>
			<td mat-cell *matCellDef="let person">{{ person.type }}</td>
		</ng-container>
		<ng-container matColumnDef="document_path">
			<th mat-header-cell *matHeaderCellDef>Documento</th>
			<td mat-cell *matCellDef="let person">{{ person.document_path ? 'Sim' : 'Não' }}</td>
		</ng-container>
		<ng-container matColumnDef="actions">
			<th mat-header-cell *matHeaderCellDef>Ações</th>
			<td mat-cell *matCellDef="let person">
				<button mat-icon-button color="accent"
					(click)="viewPerson(person.id)"><mat-icon>visibility</mat-icon></button>
				<button mat-icon-button color="primary"
					(click)="editPerson(person.id)"><mat-icon>edit</mat-icon></button>
				<button mat-icon-button color="warn"
					(click)="deletePerson(person.id)"><mat-icon>delete</mat-icon></button>
			</td>
		</ng-container>
		<tr mat-header-row
			*matHeaderRowDef="['id', 'login', 'name', 'cpf', 'email', 'address', 'type', 'document_path', 'actions']">
		</tr>
		<tr mat-row
			*matRowDef="let row; columns: ['id', 'login', 'name', 'cpf', 'email', 'address', 'type', 'document_path', 'actions'];">
		</tr>
	</table>

	<mat-paginator *ngIf="paginator" [length]="paginator.total" [pageSize]="paginator.per_page"
		[pageIndex]="paginator.current_page - 1" [pageSizeOptions]="[paginator.per_page]" (page)="onPageChange($event)">
	</mat-paginator>

	<ng-template #empty>
		<p>Nenhuma pessoa cadastrada.</p>
	</ng-template>
</div>