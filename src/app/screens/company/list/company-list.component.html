<div>
	<app-api-error [errorMessage]="apiError"></app-api-error>
	<h2>Empresas</h2>
	<button mat-raised-button color="primary" (click)="createCompany()" style="margin-bottom: 16px;">
		<mat-icon>add</mat-icon> Nova Empresa
	</button>
	<div *ngIf="loading" style="text-align:center; margin:32px 0;">
		<mat-spinner></mat-spinner>
	</div>
	<table mat-table [dataSource]="companies" class="mat-elevation-z8"
		*ngIf="!loading && companies.length > 0; else empty">
		<ng-container matColumnDef="id">
			<th mat-header-cell *matHeaderCellDef>ID</th>
			<td mat-cell *matCellDef="let company">{{ company.id }}</td>
		</ng-container>
		<ng-container matColumnDef="name">
			<th mat-header-cell *matHeaderCellDef>Nome</th>
			<td mat-cell *matCellDef="let company">{{ company.name }}</td>
		</ng-container>
		<ng-container matColumnDef="cnpj">
			<th mat-header-cell *matHeaderCellDef>CNPJ</th>
			<td mat-cell *matCellDef="let company">{{ company.cnpj }}</td>
		</ng-container>
		<ng-container matColumnDef="address">
			<th mat-header-cell *matHeaderCellDef>Endereço</th>
			<td mat-cell *matCellDef="let company">{{ company.address }}</td>
		</ng-container>
		<ng-container matColumnDef="actions">
			<th mat-header-cell *matHeaderCellDef>Ações</th>
			<td mat-cell *matCellDef="let company">
				<button mat-icon-button color="accent"
					(click)="viewCompany(company.id)"><mat-icon>visibility</mat-icon></button>
				<button mat-icon-button color="primary"
					(click)="editCompany(company.id)"><mat-icon>edit</mat-icon></button>
				<button mat-icon-button color="warn"
					(click)="deleteCompany(company.id)"><mat-icon>delete</mat-icon></button>
			</td>
		</ng-container>
		<tr mat-header-row *matHeaderRowDef="['id', 'name', 'cnpj', 'address', 'actions']"></tr>
		<tr mat-row *matRowDef="let row; columns: ['id', 'name', 'cnpj', 'address', 'actions'];"></tr>
	</table>
	<ng-template #empty>
		<p>Nenhuma empresa cadastrada.</p>
	</ng-template>

	<mat-paginator *ngIf="paginator" [length]="paginator.per_page * (paginator.to / paginator.per_page)"
		[pageSize]="paginator.per_page" [pageIndex]="paginator.current_page - 1"
		[pageSizeOptions]="[paginator.per_page]" (page)="onPageChange($event)">
	</mat-paginator>
</div>